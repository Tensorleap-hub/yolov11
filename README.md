# Object Detection Using Yolov11 Model

<div align="center">
  <img src="/ultralytics/tensorleap_folder/assets/Figure1.png" alt="Description"/>
  <figcaption><em>Figure 1 – Left: Final layer: Focus on grouped books (bottom) and individual books (top), Right: Shallow Layer: Focus on individual books across shelves.</em></figcaption>
</div>
&nbsp;

## Introduction
This project builds on **Ultralytics** repository, utilizing [YOLOv11](https://docs.ultralytics.com/models/yolo11/) model for **object detection** on [COCO](https://cocodataset.org/#home) **dataset**, which contains 122,000 natural images across 80 object classes.
Using Tensorleap, we analyze the model’s latent space, uncover hidden patterns, identify mislabeled samples, in order to **improve model performance** and dataset quality.

---

## Tensorleap Platform
Tensorleap is a platform for **visualizing, interpreting, and explaining deep learning models**. It helps teams diagnose issues, optimize performance, and build more reliable AI models. Among its many features, we’ll focus on two that are particularly relevant to this blog post.
### Latent Space
Tensorleap clusters the high dimensional latent space of the model and performs **Population Exploration (PE)** which visualizes the latent space by reducing its dimensions using t-SNE or PCA techniques. The resulting clusters exhibit semantic consistency, revealing meaningful groupings that reflect the model’s understanding of the data.

Figure 2 colors the latent space based on the amount of “train” objects (labels) in each sample- the bigger and redder the dot the more train objects appear in the image.


<div align="center">
  <img src="/ultralytics/tensorleap_folder/assets/Figure2.png" alt="Description"/>
  <figcaption><em>Figure 2 – Latent space colored by amount of train objects in each sample. The bigger and redder the dot the more train objects appear in the image. Red rectangle marks the train-related cluster.
</em></figcaption>
</div>
&nbsp;


 In Figure 3 we can see that these samples are clustered together in cluster 13, highlighting the model’s ability to organize semantically similar content.


<div align="center">
  <img src="/ultralytics/tensorleap_folder/assets/Figure3.png" alt="Description"/>
  <figcaption><em>Figure 3 – Tensorleap’s latent space clustered into semantic groups.
</em></figcaption>
</div>


### Automatically Generated Insights

Tensorleap automatically **generate insights** based on the model’s latent space. These insights are crucial for identifying model weaknesses and guiding targeted improvements. Each insight is associated with a specific cluster, presents **correlations with data attributes** (metadata), and highlights one of the following characteristics:

- Low-performance clusters.

- Overfitted regions.

- Areas of over or under representation.
---

## Project Insights and Analysis
### Insight: Over Representation cluster of Samples Containing Train Objects
One of the insights generated by the platform, was an **over-representation** cluster (Figure 4), which is linked to cluster 13 - the train-related cluster (Figure 2).
Low-performance clusters.


<div align="center">
  <img src="/ultralytics/tensorleap_folder/assets/Figure4.png" alt="Description"/>
  <figcaption><em>Figure 4 – Over representation insight, reveals a disproportionately high number of training samples compared to very few validation samples.
</em></figcaption>
</div>
&nbsp;


This insight reveals a disproportionately high number of training samples compared to very few validation samples, highlighting a **potential imbalance** in the data distribution. It also exhibits a **low bounding box** loss (which quantifies the error between predicted and ground truth object location) on the **training set**, and a **high bounding box loss** on the **validation set**. It suggests that the training samples contribute **limited new information**.
Additionally, the insight shows a strong **correlation** between the cluster’s samples and a metadata of **low occlusion** (different objects in the image contain small to no overlapping regions), indicates that this cluster contains relatively **“easy”** examples. 

Based on this insight, we hypothesize that the model has **overfitted** to these simple cases, memorizing their patterns rather than learning to generalize. 

To validate this hypothesis, we visualized some of those samples (Figure 5). As can be seen, the train images contain very minimal occlusion compared to the validation.


<div align="center">
  <img src="/ultralytics/tensorleap_folder/assets/Figure5.png" alt="Description"/>
  <figcaption><em>Figure 5- Visualization of representative samples from cluster 13. Upper row- ground truth, lower- predicted, right- validation set samples, left, train set samples.
</em></figcaption>
</div>
&nbsp;


As a result, the model performs poorly when it encounters validation samples that are a bit different, for example, images with higher overlap between objects than seen during training.

### Insight: Low performance cluster on images containes small objects
Based on the latent space, the platform extracted an additional insight as shown below (Figure 6). 


<div align="center">
  <img src="/ultralytics/tensorleap_folder/assets/Figure6.png" alt="Description"/>
  <figcaption><em>Figure 6- Small objects insight, along with the PCA derived PE, colored by median bounding box size (bluer and smaller dots represents smaller values).
</em></figcaption>
</div>
&nbsp;


An immediate hypothesis from this insight is that YOLOv11 **struggles** with **detecting small objects**. A quick review of samples from this cluster supports this idea as shown in figure 7. For example, the left column of figure 7 shows that the model manage to capture the large objects (persons, umbrella) but failed detecting the smaller ones (boats in the river). 


<div align="center">
  <img src="/ultralytics/tensorleap_folder/assets/Figure7.png" alt="Description"/>
  <figcaption><em>Figure 7- Representative cluster’s samples. Upper row- ground truth, lower row- predictions.
</em></figcaption>
</div>
&nbsp;


As a final validation, a line graph from the platform (Figure 8) confirms our assumption: As the median **bounding box area** in a sample **decreases**, the **loss increases**. This clear trend explains the poor performance observed in the two clusters and highlights the model’s difficulty in handling small objects.


<div align="center">
  <img src="/ultralytics/tensorleap_folder/assets/Figure8.png" alt="Description"/>
  <figcaption><em>Figure 8 – Loss as a function of median bounding box area.
</em></figcaption>
</div>
&nbsp;



Based on this analysis, our recommendation is to adjust the loss (which is constructed as a weighted sum of the bbox loss, class loss and focal loss) weights to place greater emphasis on focal loss to penalize small object errors more heavily.
### Insight: Low performance cluster on images with Books Objects
Another low performance cluster, as shown in Figure 9 contains 8,826 samples with a relatively **high average loss**. To understand its semantic meaning, we colored the PE based on object labels. This revealed that the cluster has a high concentration of samples **containing books**, as illustrated in Figure 10.


<div align="center">
  <img src="/ultralytics/tensorleap_folder/assets/Figure9.png" alt="Description"/>
  <figcaption><em>Figure 9- Books insight, along with the tSNE derived PE, colored amount of books presence in a sample (bluer and smaller dots represents smaller number of books).
</em></figcaption>
</div>
&nbsp;


Examining samples within this cluster reveals three potential labeling issues, Figure 10 illustrates these labeling inconsistencies:

- The books in the  dataset are **inconsistently labeled**—some are annotated while others are not, with no clear criteria.

- Books are sometimes labeled as **individual** items and other times as **grouped** items, creating ambiguity.


<p align="center">
  <img src="/ultralytics/tensorleap_folder/assets/Figure10.png" />
</p>

<p align="center">
  <em>Figure 10 – Representative samples from the cluster. Top: ground truth, bottom: predictions.</em>
</p>
&nbsp;


Figure 10 shows that in both samples, some books are annotated while others are not. Furthermore, the books are labeled inconsistently, with some identified as individual items and others grouped together. As a result, the model tends to **detect only some of the books**, and often picks different ones than the ground truth. The model also **struggles** to **distinguish** between individual books versus several books.

To investigate further, we explored the **sample analysis** provided by the platform, which offers a way to compute gradcam-like heatmaps per layer (Figure 1). The final layer of the model (to the left) shows distinct focus points on four separate books on the top shelf, while the lower shelf displays a single, broad focus area. This suggests that the model treats the entire bookshelf as one object. Interestingly, when we are looking on a shallower layer’s heatmap (right) we observed that it correctly focuses on individual books on the lower shelf. This suggests that enhancing the influence of this layer on the final prediction could help mitigate the performance issues

To support the hypothesis that inconsistent book labeling significantly affects cluster performance, we used the platform to generate a graph showing loss versus the number of books per sample (Figure 11). The results show a clear trend: as the number of **books** in each sample **increases, so does the loss** value.


<div align="center">
  <img src="/ultralytics/tensorleap_folder/assets/Figure11.png" alt="Description"/>
  <figcaption><em>Figure 11 – Loss increases with number of books per sample
</em></figcaption>
</div>
&nbsp;



---
## Wrapping Up
This analysis showed how Tensorleap can uncover hidden patterns and problems in complex models and datasets like YOLOv11 and COCO. By exploring latent space, metadata correlations, and model attention, we identified key performance issues such as overfitting, small object detection challenges, and labeling inconsistencies. These insights help guide targeted improvements, turning raw metrics into actionable understanding.
## Next Steps
* Curious how you can benefit from Tensorleap? [Reach out for a demo](https://tensorleap.ai/request-demo/).

** To generate the same results and visualizations as seen above, use filter "no info"=1.
